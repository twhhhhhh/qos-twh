<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CoreB - ch1/2 é›»è…¦è¨˜æ†¶é«”éšå±¤ | Computer Memory Hierarchy</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; }
        .draggable-item { cursor: grab; }
        .draggable-item:active { cursor: grabbing; }
        .drop-zone { transition: all 0.2s ease; }
        .drop-zone.drag-over { background-color: #dbeafe; border-color: #3b82f6; border-style: solid; }
        /* Custom Scrollbar for the info panel */
        .info-panel::-webkit-scrollbar { width: 6px; }
        .info-panel::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 4px; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-blue-600 text-white p-6 shadow-lg">
        <div class="container mx-auto max-w-5xl">
            <h1 class="text-3xl font-bold mb-2">é›»è…¦è¨˜æ†¶é«”éšå±¤äº’å‹•å¹³å°</h1>
            <p class="text-blue-100 text-sm md:text-base">Interactive Computer Memory Hierarchy Learning Platform</p>
        </div>
    </header>

    <main class="flex-grow container mx-auto max-w-5xl p-4 md:p-6 grid grid-cols-1 md:grid-cols-12 gap-6">

        <!-- Left Column: Instructions & Source Items -->
        <section class="md:col-span-4 space-y-6">
            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="bg-blue-100 text-blue-600 rounded-full w-8 h-8 flex items-center justify-center mr-2 text-sm">1</span>
                    å­¸ç¿’èˆ‡é¸æ“‡ <span class="text-sm font-normal text-gray-500 ml-2">Learn & Select</span>
                </h2>
                <p class="text-gray-600 mb-4 text-sm">
                    é»æ“Šçµ„ä»¶æŸ¥çœ‹è©³ç´°è³‡è¨Šï¼Œæˆ–å°‡å®ƒå€‘æ‹–æ”¾åˆ°å³å´æ­£ç¢ºçš„é€Ÿåº¦é †åºä¸­ã€‚
                    <br><span class="text-xs text-gray-400">Click to view details, or drag to the right to sort by speed.</span>
                </p>
                
                <!-- Source Container for Draggables -->
                <div id="source-container" class="grid grid-cols-1 gap-3 min-h-[200px] p-2 bg-gray-50 rounded-lg border border-dashed border-gray-300">
                    <!-- Items will be injected here by JS -->
                </div>
            </div>

            <!-- Info Panel (Dynamic Content) -->
            <div id="info-panel" class="bg-white p-6 rounded-xl shadow-md border-l-4 border-blue-500 hidden transition-opacity duration-300">
                <h3 class="text-lg font-bold text-blue-700 mb-1" id="info-title-zh">æ¨™é¡Œ</h3>
                <p class="text-sm text-gray-500 italic mb-4" id="info-title-en">Title EN</p>
                
                <div class="space-y-3 text-sm">
                    <div>
                        <span class="font-semibold text-gray-700 block">æ€§è³ª (Nature):</span>
                        <span id="info-nature" class="text-gray-600"></span>
                    </div>
                    <div>
                        <span class="font-semibold text-gray-700 block">ä¸€èˆ¬å®¹é‡ (Typical Capacity):</span>
                        <span id="info-capacity" class="text-gray-600"></span>
                    </div>
                    <div>
                        <span class="font-semibold text-gray-700 block">æŠ€è¡“èˆ‡åŠŸèƒ½ (Tech & Function):</span>
                        <span id="info-tech" class="text-gray-600 leading-relaxed"></span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Right Column: Sorting Game -->
        <section class="md:col-span-8">
            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 h-full flex flex-col">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold text-gray-800 flex items-center">
                        <span class="bg-blue-100 text-blue-600 rounded-full w-8 h-8 flex items-center justify-center mr-2 text-sm">2</span>
                        é€Ÿåº¦æ’åºæŒ‘æˆ° <span class="text-sm font-normal text-gray-500 ml-2">Sort by Speed</span>
                    </h2>
                    <button onclick="resetGame()" class="text-sm text-gray-500 hover:text-blue-600 underline">é‡ç½® Reset</button>
                </div>

                <div class="flex items-center justify-between text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 px-2">
                    <span>æœ€å¿« Fastest</span>
                    <span class="text-xl">â¬‡</span>
                    <span>æœ€æ…¢ Slowest</span>
                </div>

                <!-- Drop Zones Container -->
                <div class="flex-grow space-y-3" id="drop-container">
                    <!-- Drop zones will be injected here -->
                </div>

                <!-- Action Buttons -->
                <div class="mt-6 flex justify-end">
                    <button onclick="checkAnswer()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg shadow transition transform hover:-translate-y-0.5">
                        æª¢æŸ¥ç­”æ¡ˆ Check Answer
                    </button>
                </div>

                <!-- Success Explanation Area -->
                <div id="success-feedback" class="hidden mt-6 bg-green-50 border border-green-200 rounded-lg p-5">
                    <div class="flex items-start">
                        <div class="text-green-500 text-2xl mr-3">ğŸ‰</div>
                        <div>
                            <h4 class="font-bold text-green-800 text-lg mb-2">æ­£ç¢ºï¼ Correct!</h4>
                            <p class="text-green-900 text-sm mb-3 font-semibold leading-relaxed">
                                ç‚ºä»€éº¼ CPU å¯„å­˜å™¨æœ€å¿«ï¼Ÿ<br>
                                <span class="font-normal">å› ç‚ºå®ƒå€‘ä½æ–¼ CPU å…§éƒ¨ï¼Œæ˜¯è™•ç†å™¨ç›´æ¥é‹ç®—çš„å·¥ä½œå€ï¼Œæ²’æœ‰å‚³è¼¸å»¶é²ã€‚</span>
                            </p>
                             <p class="text-green-900 text-sm mb-3 font-semibold leading-relaxed">
                                Why are CPU Registers the fastest?<br>
                                <span class="font-normal">Located directly inside the CPU, they are the immediate workspace for processor operations with zero bus latency.</span>
                            </p>
                            <hr class="border-green-200 my-2">
                            <p class="text-green-900 text-sm font-semibold leading-relaxed">
                                ç‚ºä»€éº¼ HDD ç¡¬ç¢Ÿæœ€æ…¢ï¼Ÿ<br>
                                <span class="font-normal">å› ç‚ºå‚³çµ±ç¡¬ç¢Ÿä¾è³´æ©Ÿæ¢°è½‰å‹•çš„ç£ç¢Ÿå’Œè®€å¯«é ­ä¾†å°‹æ‰¾æ•¸æ“šï¼Œç‰©ç†ç§»å‹•éœ€è¦æ™‚é–“ã€‚</span>
                            </p>
                            <p class="text-green-900 text-sm font-semibold leading-relaxed">
                                Why is HDD the slowest?<br>
                                <span class="font-normal">Traditional HDDs rely on mechanical spinning platters and moving read/write heads, creating significant physical latency.</span>
                            </p>
                        </div>
                    </div>
                </div>

                 <!-- Error Feedback -->
                <div id="error-feedback" class="hidden mt-4 bg-red-50 border border-red-200 rounded-lg p-4 text-center">
                    <p class="text-red-700 font-bold">é †åºä¸æ­£ç¢ºï¼Œè«‹å†è©¦ä¸€æ¬¡ã€‚</p>
                    <p class="text-red-500 text-sm">Incorrect order. Please try again. Think about proximity to the CPU.</p>
                </div>

            </div>
        </section>
    </main>

    <footer class="bg-gray-800 text-gray-400 py-6 text-center text-sm">
        <p>Â© 2026 Computer Science Learning Platform.</p>
    </footer>

    <script>
        // Data Structure for Memory Items
        // Rank 1 is fastest
        const memoryData = [
            {
                id: 'reg',
                name_zh: 'CPU å¯„å­˜å™¨',
                name_en: 'CPU Registers',
                rank: 1,
                properties: {
                    nature: 'æ˜“å¤±æ€§ (Volatile)',
                    capacity: '< 1 KB (æ¥µå° Tiny)',
                    tech: 'ä½æ–¼ CPU æ ¸å¿ƒå…§éƒ¨çš„è¶…é«˜é€Ÿå­˜å„²å–®å…ƒï¼Œç”¨æ–¼æš«å­˜æŒ‡ä»¤å’Œæ•¸æ“šã€‚ \nUltra-fast storage inside CPU cores for immediate instructions/data.'
                }
            },
            {
                id: 'cache',
                name_zh: 'CPU å¿«å–è¨˜æ†¶é«”',
                name_en: 'CPU Cache (L1/L2/L3)',
                rank: 2,
                properties: {
                    nature: 'æ˜“å¤±æ€§ (Volatile)',
                    capacity: 'MB ç´šåˆ¥ (å° Small)',
                    tech: 'ä½¿ç”¨ SRAM æŠ€è¡“ï¼Œæ¯” RAM å¿«ä½†æ˜‚è²´ï¼Œç”¨æ–¼ç·©è¡ CPU å’Œ RAM ä¹‹é–“çš„é€Ÿåº¦å·®ç•°ã€‚ \n Uses SRAM. Faster/more expensive than RAM, buffers speed gap between CPU and RAM.'
                }
            },
            {
                id: 'ram',
                name_zh: 'éš¨æ©Ÿå­˜å–è¨˜æ†¶é«” (RAM)',
                name_en: 'Random Access Memory',
                rank: 3,
                properties: {
                    nature: 'æ˜“å¤±æ€§ (Volatile)',
                    capacity: '8GB - 64GB (ä¸­ Medium)',
                    tech: 'ä¸»è¨˜æ†¶é«” (DRAM)ã€‚é›»è…¦é‹è¡Œæ™‚çš„æš«å­˜å€ï¼Œæ–·é›»å¾Œæ•¸æ“šæ¶ˆå¤±ã€‚\n Main memory. Workspace for active programs; data is lost when power is off.'
                }
            },
            {
                id: 'rom',
                name_zh: 'å”¯è®€è¨˜æ†¶é«” (ROM)',
                name_en: 'Read-Only Memory',
                rank: 4,
                properties: {
                    nature: 'éæ˜“å¤±æ€§ (Non-volatile)',
                    capacity: 'MB ç´šåˆ¥ (å° Small)',
                    tech: 'å­˜å„²å•Ÿå‹•ç¨‹å¼ (BIOS/UEFI)ã€‚æ•¸æ“šé€šå¸¸åªèƒ½è®€å–ï¼Œæ–·é›»å¾Œä¿ç•™ã€‚ \nStores firmware/BIOS. Data is readable and retained without power.'
                }
            },
            {
                id: 'ssd',
                name_zh: 'å›ºæ…‹ç¡¬ç¢Ÿ (SSD)',
                name_en: 'Solid State Drive',
                rank: 5,
                properties: {
                    nature: 'éæ˜“å¤±æ€§ (Non-volatile)',
                    capacity: '256GB - 4TB (å¤§ Large)',
                    tech: 'ä½¿ç”¨å¿«é–ƒè¨˜æ†¶é«” (Flash Memory) å„²å­˜æ•¸æ“šã€‚æ¯” HDD å¿«ï¼Œç„¡æ©Ÿæ¢°é›¶ä»¶ã€‚ \n Uses Flash Memory. Faster than HDD, no moving parts.)'
                }
            },
            {
                id: 'hdd',
                name_zh: 'ç¡¬ç¢Ÿ (HDD)',
                name_en: 'Hard Disk Drive',
                rank: 6,
                properties: {
                    nature: 'éæ˜“å¤±æ€§ (Non-volatile)',
                    capacity: '1TB - 20TB (æ¥µå¤§ Huge)',
                    tech: 'åˆ©ç”¨ç£æ€§ç¢Ÿç‰‡æ—‹è½‰å„²å­˜ã€‚æˆæœ¬ä½ä½†é€Ÿåº¦æœ€æ…¢ã€‚ \nMagnetic spinning platters. Low cost per GB, but slowest access speeds.'
                }
            }
        ];

        // Note: Generic "CPU" was removed from sorting list as it is the processor itself, not a memory tier, 
        // effectively represented by Registers/Cache in memory hierarchy diagrams. 
        // If strictly required, it would be Rank 0 (The Brain), but for sorting "Memory Speed", it is the reference point.

        const sourceContainer = document.getElementById('source-container');
        const dropContainer = document.getElementById('drop-container');
        const infoPanel = document.getElementById('info-panel');
        let draggedItem = null;

        // Initialize Game
        function initGame() {
            // Clear containers
            sourceContainer.innerHTML = '';
            dropContainer.innerHTML = '';
            document.getElementById('success-feedback').classList.add('hidden');
            document.getElementById('error-feedback').classList.add('hidden');
            infoPanel.classList.add('hidden');

            // 1. Create Draggable Items (Shuffled)
            const shuffledData = [...memoryData].sort(() => Math.random() - 0.5);
            
            shuffledData.forEach(item => {
                const el = createDraggableElement(item);
                sourceContainer.appendChild(el);
            });

            // 2. Create Drop Zones (Ordered 1 to 6)
            for (let i = 1; i <= memoryData.length; i++) {
                const zone = document.createElement('div');
                zone.className = 'drop-zone flex items-center h-16 bg-gray-100 border-2 border-dashed border-gray-300 rounded-lg px-4 relative';
                zone.dataset.rankIndex = i; // The expected rank for this slot
                
                // Rank indicator
                const indexBadge = document.createElement('div');
                indexBadge.className = 'absolute left-0 -ml-3 bg-gray-200 text-gray-500 font-bold rounded-full w-6 h-6 flex items-center justify-center text-xs shadow-sm';
                indexBadge.innerText = i;
                zone.appendChild(indexBadge);

                // Place holder text
                const placeholder = document.createElement('span');
                placeholder.className = 'text-gray-400 text-sm w-full text-center pointer-events-none select-none';
                placeholder.innerText = i === 1 ? 'åœ¨æ­¤æ”¾ç½®æœ€å¿«çš„ (Place Fastest Here)' : (i === 6 ? 'åœ¨æ­¤æ”¾ç½®æœ€æ…¢çš„ (Place Slowest Here)' : 'æ‹–æ”¾åˆ°æ­¤ (Drop Here)');
                zone.appendChild(placeholder);

                // Events
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('dragleave', handleDragLeave);
                zone.addEventListener('drop', handleDrop);

                dropContainer.appendChild(zone);
            }
            
            // Allow dropping back to source
            sourceContainer.addEventListener('dragover', handleDragOver);
            sourceContainer.addEventListener('drop', handleDropSource);
        }

        // Create HTML for a memory item
        function createDraggableElement(item) {
            const div = document.createElement('div');
            div.className = 'draggable-item bg-white p-3 rounded shadow-sm border border-gray-200 hover:shadow-md hover:border-blue-400 transition flex justify-between items-center group';
            div.draggable = true;
            div.dataset.id = item.id;
            div.id = `item-${item.id}`;

            div.innerHTML = `
                <div>
                    <div class="font-bold text-gray-800">${item.name_zh}</div>
                    <div class="text-xs text-gray-500">${item.name_en}</div>
                </div>
                <div class="text-blue-500 opacity-0 group-hover:opacity-100 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </div>
            `;

            // Drag Events
            div.addEventListener('dragstart', (e) => {
                draggedItem = div;
                e.dataTransfer.setData('text/plain', item.id);
                setTimeout(() => div.classList.add('opacity-50'), 0);
            });

            div.addEventListener('dragend', () => {
                draggedItem = null;
                div.classList.remove('opacity-50');
            });

            // Click Event for Info
            div.addEventListener('click', (e) => {
                // Prevent click triggering if it was a drag end
                showInfo(item);
            });

            return div;
        }

        // Info Panel Logic
        function showInfo(item) {
            document.getElementById('info-title-zh').innerText = item.name_zh;
            document.getElementById('info-title-en').innerText = item.name_en;
            document.getElementById('info-nature').innerText = item.properties.nature;
            document.getElementById('info-capacity').innerText = item.properties.capacity;
            document.getElementById('info-tech').innerText = item.properties.tech;
            
            infoPanel.classList.remove('hidden');
            infoPanel.classList.add('animate-pulse');
            setTimeout(() => infoPanel.classList.remove('animate-pulse'), 500);
        }

        // Drag & Drop Handlers
        function handleDragOver(e) {
            e.preventDefault();
            if (this.classList.contains('drop-zone')) {
                this.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            if (this.classList.contains('drop-zone')) {
                this.classList.remove('drag-over');
            }
        }

        function handleDrop(e) {
            e.preventDefault();
            this.classList.remove('drag-over');
            
            // If dropping into a drop zone
            if (this.classList.contains('drop-zone')) {
                // If zone already has an item, move it back to source? Or swap? 
                // Simple version: Move existing item back to source first
                const existingItem = this.querySelector('.draggable-item');
                if (existingItem) {
                    sourceContainer.appendChild(existingItem);
                }
                
                // Clear placeholder text styling (hide span)
                const placeholder = this.querySelector('span');
                if(placeholder) placeholder.style.display = 'none';

                this.appendChild(draggedItem);
            }
        }

        function handleDropSource(e) {
            e.preventDefault();
            // Allow moving items back to source list
            sourceContainer.appendChild(draggedItem);
            
            // Restore placeholder in the previous drop zone if empty
            document.querySelectorAll('.drop-zone').forEach(zone => {
                if (!zone.querySelector('.draggable-item')) {
                    const placeholder = zone.querySelector('span');
                    if(placeholder) placeholder.style.display = 'block';
                }
            });
        }

        // Validation Logic
        function checkAnswer() {
            const dropZones = document.querySelectorAll('.drop-zone');
            let correctCount = 0;
            let isFull = true;

            dropZones.forEach(zone => {
                const item = zone.querySelector('.draggable-item');
                if (!item) {
                    isFull = false;
                    return;
                }
                
                const currentId = item.dataset.id;
                const expectedRank = parseInt(zone.dataset.rankIndex);
                
                // Find data object for current Item
                const dataItem = memoryData.find(d => d.id === currentId);
                
                if (dataItem.rank === expectedRank) {
                    correctCount++;
                    // Visual cues for correct items
                    zone.classList.remove('border-red-400', 'bg-red-50');
                    zone.classList.add('border-green-500', 'bg-green-50');
                } else {
                    zone.classList.remove('border-green-500', 'bg-green-50');
                    zone.classList.add('border-red-400', 'bg-red-50');
                }
            });

            if (!isFull) {
                alert("è«‹å…ˆå¡«æ»¿æ‰€æœ‰ç©ºæ ¼ï¼\nPlease fill all slots first!");
                return;
            }

            if (correctCount === memoryData.length) {
                document.getElementById('success-feedback').classList.remove('hidden');
                document.getElementById('error-feedback').classList.add('hidden');
                window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
            } else {
                document.getElementById('success-feedback').classList.add('hidden');
                document.getElementById('error-feedback').classList.remove('hidden');
            }
        }

        function resetGame() {
            if(confirm("ç¢ºå®šè¦é‡ç½®å—ï¼Ÿ\nAre you sure you want to reset?")) {
                initGame();
            }
        }

        // Start
        initGame();

    </script>
</body>
</html>
